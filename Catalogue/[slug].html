<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Redirecting...</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      child,
      get,
    } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAD4piXNNzWi3z1riCEl07NHnjg2IHcFhc",
      authDomain: "decor-drapes.firebaseapp.com",
      databaseURL: "https://decor-drapes-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "decor-drapes",
      storageBucket: "decor-drapes.firebasestorage.app",
      messagingSenderId: "175917446618",
      appId: "1:175917446618:web:1567dfe6a9d9c43e873ce3",
      measurementId: "G-8W8BZMLVZC"
    };

    const app = initializeApp(firebaseConfig);
    const dbRef = ref(getDatabase(app));

    const path = window.location.pathname.slice(1);

    get(child(dbRef, `redirects/${path}`))
      .then((snapshot) => {
        if (snapshot.exists()) {
          const url = snapshot.val();
          window.location.replace(url);
        } else {
          document.body.innerHTML = `
            <div class="flex flex-col items-center justify-center h-screen">
              <img src="/Logo.svg" alt="Logo" class="h-20 w-20 mb-4">
              <h1 class="text-2xl font-bold text-red-600">404 - Link Not Found</h1>
              <p class="text-gray-600 mt-2">The link you followed may be broken, or the page may have been removed.</p>
              <a href="/" class="mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Go to Homepage</a>
            </div>
          `;
        }
      })
      .catch((error) => {
        console.error(error);
      });
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-white text-center">
  <div id="loading" class="flex flex-col items-center justify-center h-screen">
    <img src="/Logo.svg" alt="Logo" class="h-20 w-20 mb-4 animate-pulse">
    <p class="text-gray-500 mt-2">Redirecting...</p>
  </div>
</body>

</html>