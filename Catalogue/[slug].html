<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Redirecting...</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      child,
      get,
    } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDXJdh4YzAK50OGK4eZwv8yxBJpuPODlyA",
      authDomain: "ddi-catalogue.firebaseapp.com",
      projectId: "ddi-catalogue",
      storageBucket: "ddi-catalogue.firebasestorage.app",
      messagingSenderId: "652157733735",
      appId: "1:652157733735:web:c2268bf8cbdecf645a7dc2"
    };

    const app = initializeApp(firebaseConfig);
    const dbRef = ref(getDatabase(app));

    const path = window.location.pathname.slice(1);

    get(child(dbRef, `redirects/${path}`))
      .then((snapshot) => {
        if (snapshot.exists()) {
          const url = snapshot.val();
          window.location.replace(url);
        } else {
          document.body.innerHTML =
            '<h1 class="text-center mt-10 text-xl text-red-600">404 - Link Not Found</h1>';
        }
      })
      .catch((error) => {
        console.error(error);
      });
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-white text-center">
  <p class="text-gray-500 mt-10">Redirecting...</p>
</body>

</html>